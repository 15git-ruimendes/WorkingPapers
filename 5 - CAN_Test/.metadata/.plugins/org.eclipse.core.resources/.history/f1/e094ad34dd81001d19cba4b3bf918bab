/*
 * CAN_Tables.h
 *
 *  Created on: Nov 23, 2022
 *      Author: RuiMendes
 */

#ifndef SRC_CAN_TABLES_H_
#define SRC_CAN_TABLES_H_

#include "main.h"

// CAN IDs Table

#define MASTER_CARD    	0xA
#define LOGCOM_CARD     0x9
#define DEBUG_CARD      0x8
#define SAC_CARD_1      0x7
#define SAC_CARD_2      0x6
#define SAC_CARD_3      0x5
#define IIS_CARD_1      0x4
#define IIS_CARD_2		0x3
#define GPRO_CARD_1     0x2
#define GPRO_CARD_2     0x1
#define TAS_CARD		0x0

// CAN Tx Commands

#define TX_STOP 		0x8
#define TX_INIT		    0x7
#define TX_START		0x6
#define TX_RETVAL		0x5
#define TX_RETSTT		0x4
#define TX_RETEVNT		0x3
#define TX_ACK          0x2
#define TX_ACTIV		0x1
#define TX_ERROR		0x0

// Card Structure

typedef struct
{
    uint8_t State;
    uint8_t SuperState;

    uint8_t* LastMsgRx;
    uint8_t  LastMsgRxSize;

    uint8_t* LastMsgTx;
    uint8_t LastMsgTxSize;

    uint8_t* ValueLog;
    uint8_t ValueLogSize;

    uint8_t* EventLog;
    uint8_t EventLogSize;

    uint8_t 

    uint8_t RxData[8];
    uint8_t TxData[8];
    uint32_t TxMailbox;
    CAN_HandleTypeDef* CANChannel;
    CAN_RxHeaderTypeDef rxHeader;
    CAN_TxHeaderTypeDef txHeader;
    CAN_FilterTypeDef filtCAN;

    TIM_HandleTypeDef* htim;

    uint8_t CardId;
} TypedefCard;


void Construct

#endif /* SRC_CAN_TABLES_H_ */
